#include <math.h>
#include <raylib.h>
#include <stdbool.h>

typedef struct {
    Vector2 position;
    bool active; 
} food_t;

#define FOOD_COUNT 10
food_t food_list[FOOD_COUNT]; 

// food positions 
void food_init() {
    for (int i = 0; i < FOOD_COUNT; i++) {
        food_list[i].position = (Vector2){ GetRandomValue(0, GetScreenWidth()), GetRandomValue(0, GetScreenHeight()) };
        food_list[i].active = true;
    }
}

// Check for collision 
int check_food_collision(Vector2 snake_head, float snake_radius, int *score) {
    for (int i = 0; i < FOOD_COUNT; i++) {
        if (food_list[i].active) {
            float dist = Vector2Distance(snake_head, food_list[i].position);
            if (dist <= snake_radius) { // Collision detected
                // Deactivate the food item and respawn at a new position
                food_list[i].position = (Vector2){ GetRandomValue(head->x-(GetScreenWidth()/2), head->x+(GetScreenWidth()/2)), GetRandomValue(head->y-(GetScreenWidth()/2), head->y+(GetScreenWidth()/2)) };
                food_list[i].active = false; // Food is eaten, deactivate it
                (*score)++; // Increase the score
                return 1; // Collision occurred
            }
        }
    }
    return 0; // No collision
}

// Draw food 
void draw_food() {
    for (int i = 0; i < FOOD_COUNT; i++) {
        if (food_list[i].active) {
            DrawCircleV(food_list[i].position, 5, GREEN); // Draw food as a small green circle
        }
    }
}
